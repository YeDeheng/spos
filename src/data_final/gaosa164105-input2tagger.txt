Testing	N
onbeforeunload	N
events	N
from	N
Selenium	N

I'm	N
trying	N
to	N
write	N
a	N
Selenium	N
test	N
for	N
a	N
web	N
page	N
that	N
uses	N
an	N
onbeforeunload	N
event	N
to	N
prompt	N
the	N
user	N
before	N
leaving	N
.	N
Selenium	N
doesn't	N
seem	N
to	N
recognize	N
the	N
confirmation	N
dialog	N
that	N
comes	N
up	N
,	N
or	N
to	N
provide	N
a	N
way	N
to	N
hit	N
OK	N
or	N
Cancel	N
.	N
Is	N
there	N
any	N
way	N
to	N
do	N
this	N
?	N
I'm	N
using	N
the	N
Java	N
Selenium	N
driver	N
,	N
if	N
that's	N
relevant	N
.	N

Warning	N
:	N
this	N
gives	N
an	N
alternate	N
solution	N
Watij	N
--	N
http://watij.com	N
--	N
can	N
help	N
here	N
.	N
Or	N
if	N
you're	N
comfortable	N
with	N
ruby	N
,	N
watir	N
can	N
help	N
--	N
http://wtr.rubyforge.org/install.html	N

You	N
could	N
write	N
a	N
user	N
extension	N
(	N
or	N
just	N
some	N
JavaScript	N
in	N
a	N
storeEval	N
etc	N
)	N
that	N
tests	N
that	N
window.onbeforeunload	N
is	N
set	N
,	N
and	N
then	N
replaces	N
it	N
with	N
null	N
before	N
continuing	N
on	N
from	N
the	N
page	N
.	N
Ugly	N
,	N
but	N
ought	N
to	N
get	N
you	N
off	N
the	N
page	N
.	N

I	N
didn't	N
end	N
up	N
doing	N
this	N
(	N
my	N
requirements	N
changed	N
such	N
that	N
I	N
was	N
better	N
off	N
using	N
a	N
regular	N
alert	N
anyway	N
)	N
,	N
but	N
this	N
looks	N
like	N
it	N
would	N
do	N
the	N
trick	N
,	N
and	N
is	N
close	N
to	N
how	N
Selenium	N
handles	N
testing	N
for	N
other	N
alerts	N
.	N

it	N
was	N
just	N
a	N
matter	N
of	N
adding	N
`	N
js_eval	N
"	N
window.onbeforeunload	N
=null	N
"`	N
before	N
an	N
open	N
for	N
me	N
.	N
(	N
selenium-client	N
in	N
Ruby	N
,	N
but	N
you	N
should	N
be	N
able	N
to	N
easily	N
translate	N
to	N
other	N
languages	N
)	N

When	N
I	N
was	N
confronted	N
with	N
limited	N
control	N
which	N
I	N
had	N
over	N
browser	N
using	N
Selenium	N
,	N
I	N
turned	N
to	N
MozLab	N
plugin	N
which	N
solved	N
my	N
problem	N
if	N
only	N
for	N
one	N
browser	N
platform	N
.	N

I've	N
just	N
had	N
to	N
do	N
this	N
for	N
an	N
application	N
of	N
mine	N
where	N
the	N
onbeforeunload	N
handler	N
brings	N
up	N
a	N
prompt	N
if	N
a	N
user	N
leaves	N
a	N
page	N
while	N
a	N
document	N
is	N
in	N
an	N
unsaved	N
state	N
.	N
Python	N
code	N
:	N
The	N
Java	N
equivalent	N
would	N
be	N
:	N
If	N
the	N
alert	N
does	N
not	N
exist	N
,	N
the	N
code	N
above	N
will	N
fail	N
with	N
a	N
NoAlertPresentException	N
so	N
there	N
is	N
no	N
need	N
for	N
a	N
separate	N
test	N
to	N
check	N
the	N
existence	N
before	N
accepting	N
the	N
prompt	N
.	N
I'm	N
running	N
Selenium	N
2.43	N
.	N
0	N
but	N
I	N
think	N
this	N
has	N
been	N
doable	N
for	N
a	N
while	N
now	N
.	N
In	N
cases	N
where	N
I	N
don't	N
want	N
the	N
prompt	N
to	N
come	N
up	N
at	N
all	N
because	N
that's	N
not	N
what	N
I'm	N
testing	N
,	N
I	N
run	N
custom	N
JavaScript	N
in	N
the	N
browser	N
to	N
set	N
window.onbeforeunload	N
to	N
null	N
before	N
leaving	N
the	N
page	N
.	N
I	N
put	N
this	N
in	N
the	N
test	N
teardown	N
code	N
.	N

